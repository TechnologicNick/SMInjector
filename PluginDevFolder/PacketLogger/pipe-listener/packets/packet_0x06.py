
from packets.packet import Packet
from construct import Int32ub, PrefixedArray, Struct

packet_0x06 = Struct(
    "checksums" / PrefixedArray(Int32ub, Int32ub),
)

class Packet_0x06(Packet):
    """File Checksums"""

    def __init__(self, id: int, data: bytes, hidden=False):
        super().__init__(id, data, hidden)

    def parse_packet(self):
        self.struct = packet_0x06.parse(self.data)
        return self.struct
    
    def modify_packet(self, direction):
        # self.struct.checksums = [2170279847, 2820916177, 3995714127, 3926603422, 3789958216, 1192259216, 1816226883, 3003539987, 3138678768, 3351700984, 84079072, 867512172, 1530295196, 1101222683, 3424163993, 375959310, 3226261412, 3107533120, 1636115385, 3778009318, 227250306, 1115742239, 2472643878, 4013415841, 2440585193, 942523894, 1485861837, 2890840784, 3006580533, 286002842, 2292064606, 2628274072, 4268028421, 3414428058, 900254290, 3614438902, 753606530, 1792879379, 2490352590, 3544535234, 2457115758, 2125704701, 1836668811, 558390944, 198876969, 2138724980, 224362200, 4131166695, 3728791797, 2559097779, 1428355804, 101074641, 1681889625, 3902472839, 1081085268, 173259768, 2960615803, 2855989359, 303905271, 3149799040, 2939861878, 2941069870, 34676897, 1082958193, 2099891675, 18898041, 3157425266, 3381456554, 163134657, 1004808103, 3837422429, 1748455315, 1962273337, 2303789516, 39254218, 1447804906, 2035314975, 3343232799, 3597287362, 1103967251, 3899144616, 152320389, 552203578, 2693988830, 3555577917, 801871185, 2344870720, 491867243, 2450231546, 1573391604, 3630668065, 1315094211, 1859020131, 2571968380, 3537125651, 3554322394, 4081954042, 3023389302, 3108239917, 3088461098, 88652154, 1814758752, 913298408, 3814882329, 3569790970, 3767122807, 2470962933, 2431787002, 4204211045, 1986835256, 1820399660, 914332670, 1970215085, 2432635102, 695877094, 2484960615, 2108635903, 468748523, 691140692, 1769868958, 1616508619, 4079908641, 3526609153, 2919416675, 993185614, 1288666198, 549997623, 721250410, 1312286224, 1506014834, 453598414, 2756824286, 3443574757, 2520026424, 3319376559, 3489276266, 2846902551, 4273101203, 4153671415, 2185268397, 3799337276, 2396550151, 924916940, 513454296, 428002577, 961441189, 2967534104, 1835160057, 3861717824, 2914907226, 2315666754, 3803628027, 315141265, 4056847678, 3376329801, 3299810245, 3151921175, 631586672, 690461276, 2076772559, 2812509581, 1968599962, 1720102630, 1970002229, 1678625626, 2654587662, 3051202571, 2332719549, 2078951224, 948739507, 2549568488, 4091698158, 355699908, 3013347616, 2077024022, 1440854752, 2882960122, 1113736661, 3781833057, 1427562386, 2895171445, 535196178, 4015887427, 2231880367, 911376168, 597473339, 442854938, 1883747030, 2064219460, 3647812619, 2724411275, 2261045390, 747097206, 3022460260, 3233950591, 3071635414, 357909016, 2677221267, 467163960, 4008129925, 217573943, 536931941, 30536299, 3000513033, 4277590756, 3244341910, 2017674699, 133084976, 420463578, 2115720504, 3289526039, 3164474513, 1256621330, 2553997165, 2455611764, 4007525811, 3132063368, 3308996929, 1287939290, 3522839095, 127605894, 1316693511, 599052313, 3313876652, 422579340, 1839365825, 2450527103, 1173097113, 3467451585, 894715624, 948745846, 1345001165, 2570938217, 2273017676, 2884770406, 2677901649, 1691473680, 3299688013, 3753747601, 2565313426, 2184013809, 3775319117, 2722720500, 2003534376, 981109450, 3034863053, 1140572278, 1459890504, 3602338885, 1248637825, 1571988844, 4092151986, 3259880140, 280466049, 1378097934, 2112793540, 2888997325, 704639041, 1886407797, 3549759890, 2108754344, 1965360675, 4015150241, 1304794199, 4121900860, 92963135, 341467469, 167157849, 3383044440, 628872620, 171662483, 1886427678, 3928358716, 3291339136, 2232761820, 2559421988, 2018464090, 1249038000, 2320442571, 3525301563, 1367013004, 307992339, 2986430512, 1414568444, 185255520, 2053845067, 3123602002, 3766205319, 1937410677, 4051105978, 4081749466, 3421393679, 2475039965, 2242667754, 1541002626, 1711949043, 3054449355, 963141737, 64011357, 1272144184, 3333665842, 1525235267, 2341307568, 2727494640, 3225684087, 1454244086, 737844246, 4004398769, 1022317125, 2260250462, 4176829348, 1840248187, 590153735, 4006515490, 2125052023, 2189048248, 3765057927, 21655225, 2618679220, 227649782, 2635320033, 2050705977, 88583695, 1319566463, 1446543340, 3239042528, 2686986782, 1744280368, 2558407711, 2006785184, 2415578758, 48340615, 2566653006, 2324641888, 4293203613, 904447466, 1876788762, 2141973734, 40920770, 4054278336, 2982441841, 1447634230, 1302368179, 3378526176]
        pass
    
    def build_packet(self):
        return packet_0x06.build(self.struct)
